# 迴圈

在生活中，我們常常會有有做一樣的事情的時候，例如比對一張一張比對發票、一行一行檢查有沒有錯字。這個要重複做的動作，在程式語言中就可以用迴圈（loop）辦到。

## 迴圈概念

迴圈簡單來說就是讓程式在你指定的條件下，一直反覆的執行。

舉個例子，小男孩寫情書給女朋友，他想要寫十行「我愛妳」，一個一個打字的話，你就要打三十個字。你可能會想，沒關係啊，我可以拷貝複製，但假設今天想要有一千行的「我愛妳」，即使是複製貼上你也會手酸。

所以這是和我們就可以用迴圈來執行這個重複的動作，我們考以寫個程式：

```txt
迴圈執行 10 遍：
    印出「我愛你」
```

我們已經跟電腦說，迴圈跑 10 遍，這是我們給迴圈的範圍條件。記住，若是沒有給範圍條件，迴圈就會永遠跑下去。如果你發現迴圈沒有停下來，通常這代表你的程式邏輯有問題，因為我們通常不允許這種事情發生。無窮迴圈通常會被系統強制終結，最糟的情況下會導致當機。

我們知道這段程式碼會執行迴圈的內容十次，所以就會印出「我愛妳」十遍：

```txt
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
我愛妳
```

如果你想要有一千遍，只要在條件範圍指定 1000 遍即可。

又或著，假設我們要計算 1 加到 100 等於多少，我們用虛擬的程式來描述看看：

```txt
sum = 0

令 i 從 0 數到 100 跑一遍：
    每次執行 sum 加上 i（意即 sum 為目前的 sum 加 i 得到的值）
```

這個虛擬碼就會開始執行迴圈，我們已經限制住迴圈的條件了，條件是 `i` 從 0 數到 100，所以 `i` 會從 0、1、2 一直數到 100，然後就停止了。每個 `i` 就是迴圈的一回合，會執行迴圈裡面的程式碼，在這邊就是 `sum` 加上 `i`。

我們必須把 `sum` 放在最一開始，也就是迴圈前面，這樣每回合才能使用 sum，如果 sum 沒有在迴圈前就先定義，每次迴圈才定義的話，迴圈結束 `sum` 就消失了，因為迴圈裡面的變數的生命只存在當下的回合，除非先把變數定義在迴圈外面，每回合操作外面變數，回合結束後，外面的變數還會保留著。這個概念就是變數的生命週期（scope），不只在迴圈中會這樣，在 `if`、`else` 等中也是如此，如果變數是在 `{}` 裡面定義，那變數的生命只在 `{}` 的區間裡面，出了就會被銷毀。

所以執行的過程會長這樣：

| i | sum | 執行完的 sum |
|:-:|:-:|:-:|
|0|0|0|
|1|0|1|
|2|1|3|
|3|3|6|
|4|6|10|
|...|...|...|
|100|4950|5050|

當這個迴圈跑完之後，我們便得到了從 1 數到 100 的總和是多少。

## JS 中的迴圈

目前為止我們已經迴圈的大至用法，接著我們來看看要如何用 JS 來實現迴圈。

### For 迴圈

先從簡單的開始，如同剛剛範例，如何用 JS 印出 5 遍「我愛妳」呢？

!FILENAME ex1.js

```js
for(let i = 0; i < 5; i++) {
    console.log("I LOVE YOU!");
}
```

執行 `ex1.js` 就會看到以下結果：

```log
$ node ex1.js
I LOVE YOU!
I LOVE YOU!
I LOVE YOU!
I LOVE YOU!
I LOVE YOU!
```

這邊開始解釋 `for(let i = 0; i < 5; i++)` 是什麼意思。在 JS 中 `for` 是一種迴圈的語法，用法是 `for(定義變數;對變數的條件;變數動作)`，首先我們定義變數，然後告訴迴圈變數的條件是什麼，最後告訴迴圈每次執行要對變數做什麼。

以這邊為例，我們先定義 `let i = 0`，然後規定 `i < 5`，一但 i 大於等於 5 迴圈就會終止，最後告訴迴圈每一回合結束 `i++`。`i++` 的意思就是 `i = i + 1`，也就是每回合 `i` 會加 1。所以 `i` 其實就是一個計數器。

最後這段程式碼的 `i` 會從 0、1、2 一直數到 4，總共 5 次。當第 5 次執行完，`i` 會變成 5 就不滿足條件，迴圈就會結束了。

習慣上我們會讓計數器從 0 開始，因為後面會介紹的陣列通常都是由 0 開始，這邊可以先當作是慣例就好。當然，我們也可以讓 `i` 從 1 開始到 5 結束，迴圈就會是 `for(let i = 1; i <= 5; i++)`。

`for` 後面包住的 `{}` 為迴圈每回合執行的程式碼，在這邊就是執行印出的動作。

再舉一個例子，我們也可以讓迴圈執行的內容與計數器有關：

!FILENAME ex2.js

```js
for(let i = 0; i < 10; i++) {
    console.log(i);
}
```

執行 `ex2.js` 就會看到以下結果：

```log
$ node ex1.js
0
1
2
3
4
```

不管是我們單純的想要跑 n 遍而已，或是想要在迴圈內執行有關計數器的動作，都可以用 `for` 定義計數器 `i` 從初始值走到條件終點。

計數器當然也可以反向來數：

!FILENAME ex3.js

```js
for(let i = 5; i > 0; i--) {
    console.log(i);
}
```

我們先讓 `i` 為 5，然後每次減一，並必須大於 0。

執行 `ex3.js` 就會看到以下結果：

```log
$ node ex1.js
5
4
3
2
1
```

還記得我們前面有用虛擬程式碼，計算 0 加到 100 等於多少，現在我們可以用 JS 來寫：

!FILENAME ex4.js

```js
let sum = 0
for(let i = 0; i <= 100; i++) {
    sum += i;
}
console.log(sum);
```

執行 `ex4.js` 就會看到以下結果：

```log
$ node ex1.js
5050
```

解釋這邊的程式碼，我們先在迴圈外面定義 `sum`，先前提過必須定義在迴圈前面，確保他的生命。然後我們讓 `i` 從 0 數到 100，每回合執行 `sum += i`，`+=` 是一種縮寫，這句等於 `sum = sum + i`，所以每回合就會把 `i` 加進 `sum` 裡面。最後迴圈結束之後，我們再印出 `sum` 是多少。